# –û—Ç—á–µ—Ç –ø–æ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–º—É –∫–∞—Ñ–µ–¥—Ä–∞–ª—å–Ω–æ–º—É –∑–∞–¥–∞–Ω–∏—é

**–§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞:** "–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–∞ –±–∞–∑–µ –û–° Windows"

**–ó–∞–¥–∞—á–∏:**
> - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Windows Event Log –¥–ª—è —Å–±–æ—Ä–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞, –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
—Å–∏—Å—Ç–µ–º—ã, –¥–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º).
> - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, OSSEC, AlienVault, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö
–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π Windows –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è).
> - –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞–Ω–∞ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä,
–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –æ –ø–æ–ø—ã—Ç–∫–µ –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤—Ö–æ–¥–∞).
> - –ü—Ä–æ–≤–µ–¥–µ–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: —Å–∏–º—É–ª—è—Ü–∏—è –∞—Ç–∞–∫ –Ω–∞ —Å–∏—Å—Ç–µ–º—É —Å —Ü–µ–ª—å—é –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∞–∫—Ü–∏–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

---

## –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –∏ –ü–û

- **–•–æ—Å—Ç–æ–≤–∞—è –û–°**: macOS Sequoia
- **–ì–æ—Å—Ç–µ–≤–∞—è –û–° (VM)**: Windows 11 Pro
- **–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞**: Graylog 6.x _(–≤ Docker)_
- **–ê–≥–µ–Ω—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è**: Winlogbeat 8.x
- **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã**: Docker, PowerShell, Telegram, Event Viewer

---

## –í—ã–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

### –ü–æ—á–µ–º—É Graylog?

**Graylog** ‚Äî —ç—Ç–æ –º–æ—â–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Å–æ–±—ã—Ç–∏–π, –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥—è—â–∞—è –¥–ª—è —É—á–µ–±–Ω—ã—Ö –∏ –º–∞–ª—ã—Ö –±–æ–µ–≤—ã—Ö 
–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä. **–û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç:**

- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–±–æ—Ä –ª–æ–≥–æ–≤ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.
- –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º –ø—Ä–∞–≤–∏–ª–∞–º.
- –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ Telegram, Email, Webhook.
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã (Beats, GELF, Syslog).
- –†–∞–±–æ—Ç–∞—Ç—å —á–µ—Ä–µ–∑ –ø–æ–Ω—è—Ç–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

![–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ-–ø—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ graylog](media/personal_task/graylog_example_screenshot.png)

### –ü–æ—á–µ–º—É Winlogbeat?

**Winlogbeat** ‚Äî –ª—ë–≥–∫–∏–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –∞–≥–µ–Ω—Ç –æ—Ç Elastic –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –ª–æ–≥–æ–≤ Windows:

- –ü—Ä–æ—Å—Ç –≤ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ.
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—ã–±–æ—Ä –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∂—É—Ä–Ω–∞–ª–æ–≤ (Security, System –∏ –¥—Ä.).
- –•–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å Graylog —á–µ—Ä–µ–∑ Logstash/Beats.
- –ù–∏–∑–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤.

![–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ github-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è winlogbeat](media/personal_task/winlogbeat_page.png)

---

## –•–æ–¥ —Ä–∞–±–æ—Ç—ã

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞—É–¥–∏—Ç–∞ –≤ Windows

–ß–µ—Ä–µ–∑ `secpol.msc` –≤–∫–ª—é—á–µ–Ω—ã –ø–æ–ª–∏—Ç–∏–∫–∏:

- –ê—É–¥–∏—Ç –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É (—É—Å–ø–µ—à–Ω—ã–π –∏ –Ω–µ—É—Å–ø–µ—à–Ω—ã–π)
- –ê—É–¥–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π
- –ê—É–¥–∏—Ç —Å–æ–∑–¥–∞–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ê—É–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ–ª–∏—Ç–∏–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

> –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–ª–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Å–æ–±—ã—Ç–∏–π: 4624, 4625, 4672, 4720, 4719.

![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ secpol –≤ wm wim](media/personal_task/task_1/secpool_setup.png)

---

### 2. –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ Graylog

**Graylog** —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç –≤ **Docker** (—Å MongoDB –∏ Elasticsearch), –æ—Ç–∫—Ä—ã—Ç –ø–æ—Ä—Ç 5044 –¥–ª—è Beats. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω 
**docker-compose**, —á—Ç–æ —É–ø—Ä–æ—Å—Ç–∏–ª–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏.

![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ graylog](media/personal_task/task_2/graylog_done.png)

**–î–ª—è –Ω–∞—á–∞–ª–∞**, —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –Ω—É–∂–Ω–æ –±—ã–ª–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏ –≤–ø–∏—Å–∞—Ç—å –∏—Ö –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã –¥–ª—è 
**docker**.

![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—ã –¥–ª—è docker-–∞ graylog](media/personal_task/task_2/ssh_setup.png)

**–î–∞–ª–µ–µ**, –Ω—É–∂–Ω–æ –±—ã–ª–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å **graylog** –ø—Ä–∏ –ø–æ–º–æ—â–∏ –∫–æ–Ω—Ñ–∏–≥–∞ **docker-compose**.

![—Å–∫—Ä–∏–Ω—à–æ—Ç –∑–∞–ø—É—Å–∫–∞ graylog —á–µ—Ä–µ–∑ docker-compose](media/personal_task/task_2/graylog_startup.png)

**–ü–æ—Å–ª–µ —á–µ–≥–æ**, –∏—Å–ø–æ–ª—å–∑—É—è –ø–∞—Ä–æ–ª—å –∏–∑ –ª–æ–≥–æ–≤ **docker**, –∑–∞–π—Ç–∏ –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É.

![—Å–∫—Ä–∏–Ω—à–æ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π –Ω–∞—á–∞–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ graylog](media/personal_task/task_2/graylog_startup_guide.png)

---

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Winlogbeat

–ù–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π Windows:

- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω **Winlogbeat**
- –ù–∞—Å—Ç—Ä–æ–µ–Ω `winlogbeat.yml` (output ‚Üí –ª–æ–≥—Å—Ç—ç—à –Ω–∞ —Ö–æ—Å—Ç–µ)
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–∞–∫ —Å–µ—Ä–≤–∏—Å
- –ó–∞–ø—É—â–µ–Ω

![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ winlogbeat](media/personal_task/task_3/winlogbeat_done.png)

**–î–ª—è –Ω–∞—á–∞–ª–∞** –Ω—É–∂–Ω–æ –±—ã–ª–æ —Å–∫–∞—á–∞—Ç—å –∞—Ä—Ö–∏–≤ —Å **winlogbeat** —Å —Å–∞–π—Ç–∞ –∏ –Ω–∞–ø–∏—Å–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É 
**graylog** –≤ **docker**.

![—Å–∫—Ä–∏–Ω—à–æ—Ç —Å–¥–µ–ª–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ñ–∏–≥–∞ –¥–ª—è winlogbeat (—á–∞—Å—Ç—å 1)](media/personal_task/task_3/winlogbeat_config_1.png)

![—Å–∫—Ä–∏–Ω—à–æ—Ç —Å–¥–µ–ª–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ñ–∏–≥–∞ –¥–ª—è winlogbeat (—á–∞—Å—Ç—å 2)](media/personal_task/task_3/winlogbeat_config_2.png)

–î–∞–ª–µ–µ, –Ω—É–∂–Ω–æ –±—ã–ª–æ —á–µ—Ä–µ–∑ **powershell** —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å **winlogbeat** –∫–∞–∫ —Å–µ—Ä–≤–∏—Å –≤ **Windows 11** –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å.

![—Å–∫—Ä–∏–Ω—à–æ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ winlogbeat –∏ –µ–≥–æ –∑–∞–ø—É—Å–∫–∞](media/personal_task/task_3/winlogbeat_install.png)

---

### 4. –°–æ–∑–¥–∞–Ω–∏–µ Stream'–æ–≤

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –±—ã–ª —Å–æ–∑–¥–∞–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π stream (–¥–ª—è –¥–∞–ª—å–Ω–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ **telegram** —á–µ—Ä–µ–∑
**alert-—ã**).

![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö stream-–æ–≤ –≤ graylog](media/personal_task/task_4/stream_done.png)

| –°–æ–±—ã—Ç–∏–µ               | Event ID | –£—Å–ª–æ–≤–∏–µ –¥–ª—è –∞–ª–µ—Ä—Ç–∞ |
|-----------------------|----------|--------------------|
| –ù–µ—É–¥–∞—á–Ω—ã–µ –≤—Ö–æ–¥—ã       | 4625     | >3 –∑–∞ 5 –º–∏–Ω—É—Ç      |
| –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥         | 4624     | >1 –∑–∞ 1 –º–∏–Ω—É—Ç—É     |
| –ê–¥–º–∏–Ω—Å–∫–∏–π –≤—Ö–æ–¥        | 4672     | –∫–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ     |
| –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | 4720     | –∫–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ     |
| –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∞—É–¥–∏—Ç–∞      | 4719     | –∫–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ     |

**–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –∏ –ø–ª–∞–Ω —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è:**

| Event ID | –ù–∞–∑–≤–∞–Ω–∏–µ                  | –°–º—ã—Å–ª —Å–æ–±—ã—Ç–∏—è                             | –£–≥—Ä–æ–∑–∞                     | –ü–ª–∞–Ω —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è                              |
|----------|---------------------------|-------------------------------------------|----------------------------|------------------------------------------------|
| 4625     | –ù–µ—É–¥–∞—á–Ω—ã–π –≤—Ö–æ–¥            | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å                 | –ü–æ–¥–±–æ—Ä –ø–∞—Ä–æ–ª—è, brute-force | –ê–ª–µ—Ä—Ç >3 –∑–∞ 5 –º–∏–Ω, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –∏–ª–∏ —É—á—ë—Ç–∫–∏    |
| 4624     | –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥             | –£—Å–ø–µ—à–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è                      | –ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø         | –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, –∞–ª–µ—Ä—Ç –ø–æ –≤—Ä–µ–º–µ–Ω–∏      |
| 4672     | –í—Ö–æ–¥ —Å –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏       | –í—Ö–æ–¥ —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞             | –≠—Å–∫–∞–ª–∞—Ü–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π       | –ê–ª–µ—Ä—Ç –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Å–ª—É—á–∞–µ, –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| 4720     | –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è     | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞   | –ê–ª–µ—Ä—Ç, –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫—Ç–æ —Å–æ–∑–¥–∞–ª, —É–¥–∞–ª–µ–Ω–∏–µ           |
| 4719     | –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –∞—É–¥–∏—Ç–∞ | –ò–∑–º–µ–Ω–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏           | –°–∫—Ä—ã—Ç–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏         | –ê–ª–µ—Ä—Ç, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ, —Ä–∞–∑–±–æ—Ä –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é  |

**–°–Ω–∞—á–∞–ª–∞**, –±—ã–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω **input** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ª–æ–≥–æ–≤ —Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã.

![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ input –≤ graylog](media/personal_task/task_4/input_setup.png)

**–î–∞–ª–µ–µ**, –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ —Å–æ–±—ã—Ç–∏–π –±—ã–ª —Å–æ–∑–¥–∞–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π **stream**, –∫—É–¥–∞ –ø—Ä–∏—Ö–æ–¥–∏–ª–∏ –±—ã –Ω—É–∂–Ω—ã–µ –ª–æ–≥–∏ (—Å–æ–≥–ª–∞—Å–Ω–æ event_id).

![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ stream –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞](media/personal_task/task_4/stream_success_login.png)
![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ stream –¥–ª—è –Ω–µ—É–¥–∞—á–Ω–æ–≥–æ –≤—Ö–æ–¥–∞](media/personal_task/task_4/stream_failed_login.png)
![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ stream –¥–ª—è –≤—Ö–æ–¥–∞ —Å –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏](media/personal_task/task_4/stream_admin_login.png)
![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ stream –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è](media/personal_task/task_4/stream_create_user.png)
![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ stream –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ø–æ–ª–∏—Ç–∏–∫–µ –∞—É–¥–∏—Ç–∞](media/personal_task/task_4/stream_audit_change.png)

---

### 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

- –°–æ–∑–¥–∞–Ω –±–æ—Ç –≤ **@BotFather**
- –ü–æ–ª—É—á–µ–Ω chat_id
- –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ HTTP Notification:
    - URL: `https://api.telegram.org/bot<TOKEN>/sendMessage`
    - –ú–µ—Ç–æ–¥: POST
    - Content-Type: application/json
    - Body:
      ```json
      {
        "chat_id": "123456789",
        "text": "üö® Graylog Alert!\nStream: ${event.stream_title}\nEvent: ${event.event_definition_title}\nTime: ${event.timestamp}\n\nMessage:\n${event.message}"
      }
      ```

–ù–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω–æ –∫–∞–∫ –≤ **graylog** –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å **api telegram** –∏ —Å–¥–µ–ª–∞–Ω –ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π **alert**.

![—Å–∫—Ä–∏–Ω—à–æ—Ç –∫–æ–Ω—Ñ–∏–≥–∞ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ telegram](media/personal_task/task_5/notificator_config_1.png)
![—Å–∫—Ä–∏–Ω—à–æ—Ç –∫–æ–Ω—Ñ–∏–≥–∞ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ telegram](media/personal_task/task_5/notificator_config_2.png)

---

### 6. –°–æ–∑–¥–∞–Ω–∏–µ Alert'–æ–≤

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –±—ã–ª —Å–æ–∑–¥–∞–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π **alert** –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ **telegram** –±–æ—Ç.

![—Å–∫—Ä–∏–Ω—à–æ—Ç —Å–æ –≤—Å–µ–º–∏ –≥–æ—Ç–æ–≤—ã–º–∏ alert-–∞–º–∏](media/personal_task/task_6/alert_done.png)

–ù–∏–∂–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã —Å –ø–æ–¥—Ä–æ–±–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ **alert-–∞**.

![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ alert-–æ–≤ 1](media/personal_task/task_6/alert_1.png)
![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ alert-–æ–≤ 2](media/personal_task/task_6/alert_2.png)
![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ alert-–æ–≤ 3](media/personal_task/task_6/alert_3.png)
![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ alert-–æ–≤ 4](media/personal_task/task_6/alert_4.png)
![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ alert-–æ–≤ 5](media/personal_task/task_6/alert_5.png)
![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ alert-–æ–≤ 6](media/personal_task/task_6/alert_6.png)
![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ alert-–æ–≤ 7](media/personal_task/task_6/alert_7.png)
![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ alert-–æ–≤ 8](media/personal_task/task_6/alert_8.png)
![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ alert-–æ–≤ 9](media/personal_task/task_6/alert_9.png)
![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ alert-–æ–≤ 10](media/personal_task/task_6/alert_10.png)
![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ alert-–æ–≤ 11](media/personal_task/task_6/alert_11.png)
![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ alert-–æ–≤ 12](media/personal_task/task_6/alert_12.png)
![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ alert-–æ–≤ 13](media/personal_task/task_6/alert_13.png)
![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ alert-–æ–≤ 14](media/personal_task/task_6/alert_14.png)
![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ alert-–æ–≤ 15](media/personal_task/task_6/alert_15.png)
![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ alert-–æ–≤ 16](media/personal_task/task_6/alert_16.png)
![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ alert-–æ–≤ 17](media/personal_task/task_6/alert_17.png)
![—Å–∫—Ä–∏–Ω—à–æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ alert-–æ–≤ 18](media/personal_task/task_6/alert_18.png)

---

### 7. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (—Å–∏–º—É–ª—è—Ü–∏—è –∞—Ç–∞–∫)

- –í–≤–æ–¥ –Ω–µ–≤–µ—Ä–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è (4625)
- –í—Ö–æ–¥ —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (4672)
- –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ **PowerShell**:
  `net user test P@ssword123 /add`
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –∞—É–¥–∏—Ç–∞ –≤ `secpol.msc`

–í—Å–µ —Å–æ–±—ã—Ç–∏—è –±—ã–ª–∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –∏ –ø–µ—Ä–µ–¥–∞–Ω—ã –≤ Graylog, –≥–¥–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∏ –∞–ª–µ—Ä—Ç—ã –∏ –æ—Ç–ø—Ä–∞–≤–∏–ª–∏—Å—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram.

![—Å–∫—Ä–∏–Ω—à–æ—Ç —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –≤—Å–µ—Ö –ª–æ–≥–æ–≤](media/personal_task/task_7/test_all_messages.png)

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–µ—É–¥–∞—á–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É –±—ã–ª —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–∞—Ä–æ–ª—å –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫.
![—Å–∫—Ä–∏–Ω—à–æ—Ç —Ç–µ—Å—Ç–∞ —Å –Ω–µ—É–¥–∞—á–Ω—ã–º –≤—Ö–æ–¥–æ–º](media/personal_task/task_7/test_failed_login.png)

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É–¥–∞—á–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ –≤—ã—à–µ–ª –∏–∑ —Å–µ–∞–Ω—Å–∞ –∏ –≤—ã–ø–æ–ª–Ω–∏–ª –≤—Ö–æ–¥ –∑–∞–Ω–æ–≤–æ.
![—Å–∫—Ä–∏–Ω—à–æ—Ç —Ç–µ—Å—Ç–∞ —Å —É–¥–∞—á–Ω—ã–º –≤—Ö–æ–¥–æ–º](media/personal_task/task_7/test_success_login.png)

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Ö–æ–¥–∞ —Å –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏ —Ç–∞–∫ –∂–µ –≤—ã—à–µ–ª –∏–∑ —Å–µ–∞–Ω—Å–∞ –∏ –≤–æ—à–µ–ª –∑–∞–Ω–æ–≤–æ (—Ä–∞–±–æ—Ç—É –≤–µ–ª –∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∞).
![—Å–∫—Ä–∏–Ω—à–æ—Ç —Ç–µ—Å—Ç–∞ —Å –≤—Ö–æ–¥–æ–º –∞–¥–º–∏–Ω–∞ 1](media/personal_task/task_7/test_admin_login_1.png)
![—Å–∫—Ä–∏–Ω—à–æ—Ç —Ç–µ—Å—Ç–∞ —Å –≤—Ö–æ–¥–æ–º –∞–¥–º–∏–Ω–∞ 2](media/personal_task/task_7/test_admin_login_2.png)

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–≤–µ–ª –≤ **powershell** —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É.
![—Å–∫—Ä–∏–Ω—à–æ—Ç —Å —Ç–µ—Å—Ç–æ–º —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è](media/personal_task/task_7/test_create_user.png)

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ–ª–∏—Ç–∏–∫ –∞—É–¥–∏—Ç–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ —Å–¥–µ–ª–∞–ª –ø—Ä–∞–≤–∫–∏ –≤ –æ–¥–∏–Ω –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —á–µ—Ä–µ–∑ `secpol.msc`.
![—Å–∫—Ä–∏–Ω—à–æ—Ç —Å —Ç–µ—Å—Ç–æ–º –ø–æ–ª–∏—Ç–∏–∫ –∞—É–¥–∏—Ç–∞](media/personal_task/task_7/test_audit.png)

---

## –í—ã–≤–æ–¥
